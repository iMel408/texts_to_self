{% extends 'base.html' %}
{% block content %}

  <h3>Profile: {{ user.username }}</h3>


  {% if job %}

  <h4>Job Settings:</h4>


    <ul>

     <li> <b>{{ job.frequency.title() }} </b> @ <b> {{ local_job_time }} </b> -  {% if job.active %} <b><font color="green"> Active</b> </font> {% else %} <b> <font color="red" > Inactive</b> </font> {% endif %}
         <a href="{{  url_for('main.update', id=job['id']) }}">[update]</a></li>
    </ul>

{% else %}

 <h4>Job Settings:</h4> <li> <a href="{{  url_for('main.setup') }}">Setup</a></li>

  {% endif %}

  {% if events %}

<canvas id="chart" width="900" height="400"></canvas>
<script>

Chart.defaults.global.animationSteps = 50;
Chart.defaults.global.tooltipYPadding = 16;
Chart.defaults.global.tooltipCornerRadius = 0;
Chart.defaults.global.tooltipTitleFontStyle = "normal";
Chart.defaults.global.tooltipFillColor = "rgba(0,0,0,0.8)";
Chart.defaults.global.animationEasing = "easeOutBounce";
Chart.defaults.global.responsive = false;
Chart.defaults.global.scaleLineColor = "black";
Chart.defaults.global.scaleFontSize = 16;

let ctx = document.getElementById("chart").getContext("2d");

/*** Gradient ***/
let gradient = ctx.createLinearGradient(0, 0, 0, 400);
    gradient.addColorStop(0, 'rgba(250,174,50,1)');
    gradient.addColorStop(1, 'rgba(250,174,50,0)');
/***************/

let data = {
            labels : [{% for item in labels %}
                        "{{ item }}",
                        {% endfor %}],
            datasets: [
                {
                    label: "{{ title }}",
                    fillColor : gradient,
                    strokeColor : "#ff6c23",
                    pointColor : "#fff",
                    pointStrokeColor : "#ff6c23",
                    pointHighlightFill: "#fff",
                    pointHighlightStroke: "#ff6c23",
                    data : [{% for item in values %}
                        {{ item[0] }},
                        {% endfor %}]
                }
            ]
        };

        let options = {
            responsive: true,
            datasetStrokeWidth : 3,
            pointDotStrokeWidth : 4,
            tooltipFillColor: "rgba(0,0,0,0.8)",
            tooltipFontStyle: "bold",
            tooltips: {
                enabled: true,
                mode: 'single',
                callbacks: {
                    label: function(tooltipItems, values) {
                        return tooltipItems.yLabel + {% for items in values %}
                        {% if items[1] %}
                        " {{ items[1] }}"
                        {% endif %}
                    {% endfor %};
                    }
                }
            },
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            }
      };

    let myLineChart = new Chart(ctx, {
        type: 'line',
        data: data,
        options: options
    });
</script>

    <h3>Log:</h3><a href="{{  url_for('main.setup') }}">Edit</a>
     {% for event in events %}

        <li>{{ event.date_added.strftime("%m-%d-%y") }} : {{ event.msg_body }}
            {% if event.comment %}
            <font color="#00008b"><i> - {{ event.comment }}</font></i> </li> </h4>
  {% endif %}
    {% endfor %}

  {% endif %}

<!--utc_now {{ current_time_utc }}-->

{% endblock %}